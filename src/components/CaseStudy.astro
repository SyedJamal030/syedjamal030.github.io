---
import type { CollectionEntry } from "astro:content";
interface Props {
  study: CollectionEntry<"cases">;
  index: number;
}

const { study, index } = Astro.props;
const { Content } = await study.render();
---

<article class="grid lg:grid-cols-12 gap-12 items-start">
  {/* Left Sidebar - Sticky */}
  <div
    class={`lg:col-span-5 sticky top-32 ${index % 2 !== 0 ? "lg:order-last" : ""}`}
  >
    <div
      class={`inline-block px-3 py-1 mb-4 text-[10px] font-bold uppercase tracking-widest rounded bg-primary/10 text-primary border border-primary/20`}
    >
      Project: {study.data.project}
    </div>
    <h2 class="text-3xl font-bold mb-6">{study.data.title}</h2>

    <div class="space-y-6">
      <div class="p-6 rounded-xl border border-border bg-secondary/5">
        <h4
          class="text-sm font-bold uppercase tracking-widest mb-4 text-secondary"
        >
          Senior Insights
        </h4>
        <ul class="space-y-4">
          {
            study.data.insights.map((insight, i) => (
              <li class="flex gap-3 text-sm">
                <span class="text-primary font-mono">0{i + 1}</span>
                <span>{insight}</span>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </div>

  <div class="lg:col-span-7 prose dark:prose-invert prose-lg max-w-none">
    <p
      class={`text-xl leading-relaxed italic border-l-4 border-primary pl-6 py-2 bg-muted/30 rounded-r-lg`}
    >
      "{study.data.narrativeIntro}"
    </p>

    <div class="mt-8">
      <Content />
    </div>

    {/* Lead Reflection Box */}
    <div
      class="mt-12 p-8 rounded-2xl bg-secondary/5 border border-border border-l-4 border-l-secondary"
    >
      <h5
        class="text-xs font-black uppercase tracking-[0.2em] mb-4 text-foreground/80"
      >
        Lead Reflection: {study.data.leadReflectionTitle}
      </h5>
      <p class="text-base italic leading-relaxed text-muted-foreground">
        "{study.data.leadReflectionBody}"
      </p>
    </div>
  </div>
</article>
