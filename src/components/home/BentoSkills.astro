---
import { getEntry } from "astro:content";
import Counter from "./Counter.astro";
const skillsManifest = await getEntry("skills", "main");

const gridMap = {
  large: "md:col-span-7 lg:col-span-6 md:row-span-2", // Takes up roughly half the width
  tall: "md:col-span-5 lg:col-span-3 md:row-span-2", // Sleek vertical card
  small: "md:col-span-6 lg:col-span-3 md:row-span-1", // Fits next to the tall card
};

const colorMap = {
  primary: "text-primary border-primary/20",
  secondary: "text-secondary border-secondary/20",
  info: "text-info border-info/20",
};
---

<section class="py-24">
  <div class="lg:container mx-auto px-6">
    <h2 class="text-3xl font-bold mb-12">The Skillset</h2>
    <div class="grid grid-cols-1 md:grid-cols-12 gap-4 auto-rows-[220px]">
      {
        skillsManifest?.data.categories.map((cat) => (
          <div
            class:list={[
              gridMap[cat.size],
              "rounded-xl border p-6 flex flex-col justify-between transition-all duration-500 hover:shadow-xl",
              cat.layoutType === "metric"
                ? "bg-secondary/5"
                : "bg-card border-border",
            ]}
          >
            {cat.layoutType === "metric" ? (
              <div class="flex flex-col items-center justify-center h-full text-center group">
                <div class="text-6xl font-black text-secondary mb-2 group-hover:scale-110 transition-transform">
                  <Counter
                    target={cat.metricValue ?? 0}
                    suffix={cat.suffix}
                    prefix={cat.prefix}
                  />
                </div>
                <p class="text-xs font-bold uppercase tracking-widest">
                  {cat.description}
                </p>
              </div>
            ) : (
              <>
                <div>
                  <h3 class:list={["text-xl font-bold", colorMap[cat.color]]}>
                    {cat.title}
                  </h3>
                  <p class="text-muted-foreground mt-2 text-sm leading-relaxed">
                    {cat.description}
                  </p>
                </div>
                <div class="flex gap-2 flex-wrap">
                  {cat.skills.map((skill) => (
                    <span class="px-2.5 py-1 bg-muted/50 border border-border rounded-full text-[10px] font-mono">
                      {skill}
                    </span>
                  ))}
                </div>
              </>
            )}
          </div>
        ))
      }
    </div>
  </div>
</section>
